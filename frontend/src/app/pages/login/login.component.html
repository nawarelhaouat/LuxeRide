<div class="login-page">

  <!-- Overlay flou -->
  <div *ngIf="showForgotModal" class="modal-overlay" (click)="closeForgotModal()"></div>

  <!-- CONTAINER MODAL (s'affiche seulement si modal ouverte) -->
  <div *ngIf="showForgotModal" class="modal-container">

    <!-- =============================
         CARD NORMALE (Entrer email)
         ============================= -->
    <div class="modal-card" *ngIf="!forgotSuccess">

      <!-- Bouton fermer -->
      <i class="bi bi-x close-btn" (click)="closeForgotModal()"></i>

      <h2 class="modal-title">Récupérer l'accès</h2>
      <p class="modal-text">
        Entrez votre email pour recevoir le nouveau code.
      </p>

      <!-- Champ email -->
      <div class="input-icon-wrapper">
        <i class="bi bi-envelope"></i>
        <input 
          type="email"
          placeholder="Adresse email"
          [(ngModel)]="forgotEmail"
          name="forgotEmail"
          required
        />
      </div>

      <!-- Erreur -->
      <div *ngIf="forgotError" class="error-message">
        <i class="bi bi-exclamation-circle"></i>
        {{ forgotError }}
      </div>

      <!-- Bouton envoyer -->
      <button class="modal-btn"
              (click)="sendRecoveryEmail()"
              [disabled]="!forgotEmail || loadingForgotEmail">

        <span *ngIf="!loadingForgotEmail">Envoyer</span>
        <span *ngIf="loadingForgotEmail" class="loader"></span>
      </button>

    </div>


    <!-- =============================
         CARD SUCCÈS (Email envoyé)
         ============================= -->
    <div class="modal-card success-card" *ngIf="forgotSuccess">

      <!-- Bouton fermer -->
      <i class="bi bi-x close-btn" (click)="closeForgotModal()"></i>

      <div class="success-content">
        <div class="success-icon-circle">
          <i class="bi bi-check2"></i>
        </div>

        <h3 class="success-title">Email envoyé !</h3>
        <p class="success-text">
          Vérifiez votre boîte mail pour récupérer le nouveau code.
        </p>
      </div>

    </div>

  </div>
  <!-- FIN MODAL -->


  <!-- =============================
       LOGIN PRINCIPAL
       ============================= -->
  <div class="login-card">

    <div class="login-icon">
      <img src="assets/images/logo.png" alt="Logo" class="logo-img">
    </div>

    <p class="login-subtitle">Portail d'administration sécurisé</p>

    <form #f="ngForm" (ngSubmit)="submit(f)">

      <div class="input-icon-wrapper">
        <i class="bi bi-lock"></i>

        <input 
          [type]="showPassword ? 'text' : 'password'"
          placeholder="Code administrateur"
          ngModel 
          name="code"
          required 
        />

        <i class="bi toggle-password-icon"
           [class.bi-eye]="!showPassword"
           [class.bi-eye-slash]="showPassword"
           (click)="togglePassword()"></i>
      </div>

      <!-- Erreur login -->
      <div *ngIf="errorMessage" class="error-message">
        <i class="bi bi-exclamation-circle"></i>
        {{ errorMessage }}
      </div>

      <!-- Bouton connexion -->
      <button class="login-btn" type="submit"
              [disabled]="loading || f.invalid">

        <span *ngIf="!loading">Accéder</span>
        <span *ngIf="loading" class="loader"></span>
      </button>

      <!-- Mot de passe oublié -->
      <a class="forgot-link" (click)="openForgotModal()">
        Mot de passe oublié ?
      </a>

    </form>

    <div class="login-footer">
      © 2025 LuxeRide Admin. Tous droits réservés.
    </div>

  </div>
</div>
